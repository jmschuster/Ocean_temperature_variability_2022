# CTI model; barrens only
mBarren1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitiity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
########## MODEL COMMUNITY CHANGE FOR EACH HABITAT TYPE SEPARATELY ##########
### CTI
# CTI model; barrens only
mBarren1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
########## MODEL COMMUNITY CHANGE FOR EACH HABITAT TYPE SEPARATELY ##########
### CTI
# CTI model; barrens only
mBarren1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixed1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren1)
summary(mKelp1)
summary(mMixed1)
########## MODEL COMMUNITY CHANGE FOR EACH HABITAT TYPE SEPARATELY ##########
### CTI
# CTI model; barrens only
mBarren1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & Habitat=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & Habitat=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixed1<-lme(data=subset(KFM_Fish_Diversity_NoAge,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & Habitat=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# Which sites have urchin densities >4 per m^2 on average in 3 yrs prior to event?
BarrenSites<-blobURCHINS %>% filter(SurveyYear <2014 & SurveyYear>2010 & YearEstablished<2001) %>% group_by(SiteName) %>% dplyr::summarize(mean=mean(MeanDensity_sqm))
# Which sites have >80 stipes of adult macrocystis?
KelpSites<-KELP %>% filter(SurveyYear <2014 & SurveyYear>2010 & YearEstablished<2001) %>% filter(DimensionsMeasured=='Stipe_Count') %>% group_by(SiteName,SurveyYear) %>% dplyr::summarize(mean=mean(TotalCount))
# SENSITIVITY TEST: using >6 urchins per m^2 and >100 kelp stipes
blobCommunity_VT <- blobCommunity_VT %>%
mutate(HabitatSensitivity = case_when(
SiteName=="Johnson's Lee North" ~ "Kelp",
SiteName=="Johnson's Lee South" ~ "Kelp",
SiteName=="Landing Cove" ~ "Kelp",
SiteName=="Wyckoff Ledge" ~ "Kelp",
SiteName=='Cathedral Cove' ~ "Kelp",
SiteName=="Fry's Harbor" ~ "Kelp",
SiteName=="Arch Point" ~ "Barren",
SiteName=="Pelican Bay" ~ "Barren",
SiteName=="Scorpion Anchorage" ~ "Barren",
SiteName=='Hare Rock' ~ "Mixed", # classified as "Mixed" with >6urchins/m^2
SiteName=="SE Sea Lion Rookery" ~ "Barren",
SiteName=="Cat Canyon" ~ "Barren",
SiteName=="Yellow Banks" ~ "Mixed",
SiteName=="Gull Island South" ~ "Mixed",
SiteName=="Admiral's Reef" ~ "Mixed",
SiteName=="Rodes Reef" ~ "Mixed"))
KFM_Fish_Diversity_NoAge$HabitatSensitivity <- factor(KFM_Fish_Diversity_NoAge$HabitatSensitivity,
levels = c("Kelp","Barren", "Mixed"))
blobCommunity_VT$HabitatSensitivity <- factor(blobCommunity_VT$HabitatSensitivity,
levels = c("Kelp","Barren", "Mixed"))
View(blobCommunity_VT)
########## MODEL COMMUNITY CHANGE FOR EACH HABITAT TYPE SEPARATELY ##########
### CTI
# CTI model; barrens only
mBarrenBlob<-lme(data=subset(blobCommunity_VT,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelpBlob<-lme(data=subset(blobCommunity_VT,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & Habitat=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mKelpBlob)
# CTI model; kelp only
mKelpBlob<-lme(data=subset(blobCommunity_VT,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mKelpBlob)
# CTI model; mixed habitat only
mMixedBlob<-lme(data=subset(blobCommunity_VT,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarrenBlob)
summary(mKelpBlob)
summary(mMixedBlob)
KFM_RovingFish_Diversity<- KFM_RovingFish_Diversity %>%
mutate(HabitatSensitivity = case_when(
SiteName=="Johnson's Lee North" ~ "Kelp",
SiteName=="Johnson's Lee South" ~ "Kelp",
SiteName=="Landing Cove" ~ "Kelp",
SiteName=="Wyckoff Ledge" ~ "Mixed", #changes class
SiteName=="Yellow Banks" ~ "Kelp",
SiteName=="Arch Point" ~ "Barren",
SiteName=="Gull Island South" ~ "Barren",
SiteName=="Pelican Bay" ~ "Barren",
SiteName=="Scorpion Anchorage" ~ "Barren",
SiteName=="SE Sea Lion Rookery" ~ "Barren",
SiteName=='Hare Rock' ~ "Mixed", #changes class
SiteName=="Fry's Harbor" ~ "Mixed", #changes class
SiteName=='Cathedral Cove' ~ "Mixed",
SiteName=="Cat Canyon" ~ "Mixed",
SiteName=="Admiral's Reef" ~ "Mixed",
SiteName=="Rodes Reef" ~ "Mixed"))
View(KFM_RovingDiverFishCount_82_19)
View(KFM_RovingFish_Diversity)
### CTI
# CTI model; barrens only
mBarren5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & Habitat=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & Habitat=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5)
summary(mKelp5)
summary(mMixed5)
### CTI
# CTI model; barrens only
mBarren5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5)
summary(mKelp5)
summary(mMixed5)
# CTI model; kelp only
mKelp5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mKelp5)
# CTI model; mixed habitat only
mMixed5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mMixed5)
blobCommunity_RD <- blobCommunity_RD %>%
mutate(HabitatSensitivity = case_when(
SiteName=="Johnson's Lee North" ~ "Kelp",
SiteName=="Johnson's Lee South" ~ "Kelp",
SiteName=="Landing Cove" ~ "Kelp",
SiteName=="Wyckoff Ledge" ~ "Kelp",
SiteName=='Cathedral Cove' ~ "Kelp",
SiteName=="Fry's Harbor" ~ "Kelp",
SiteName=="Arch Point" ~ "Barren",
SiteName=="Pelican Bay" ~ "Barren",
SiteName=="Scorpion Anchorage" ~ "Barren",
SiteName=='Hare Rock' ~ "Mixed", # classified as "Mixed" with >6urchins/m^2
SiteName=="SE Sea Lion Rookery" ~ "Barren",
SiteName=="Cat Canyon" ~ "Barren",
SiteName=="Yellow Banks" ~ "Mixed",
SiteName=="Gull Island South" ~ "Mixed",
SiteName=="Admiral's Reef" ~ "Mixed",
SiteName=="Rodes Reef" ~ "Mixed"))
### CTI
# CTI model; barrens only
mBarren5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & Habitat=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & Habitat=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixed5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & Habitat=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5Blob)
summary(mKelp5Blob)
summary(mMixed5Blob)
### CTI
# CTI model; barrens only
mBarren5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixed5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5Blob)
summary(mKelp5Blob)
summary(mMixed5Blob)
ggplot(data=subset(blobCommunity_VT,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & Habitat !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=Habitat, colour=Habitat))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='C')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
ggplot(data=subset(blobCommunity_VT,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, colour=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='C')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
##### COMMUNITY THERMAL INDEX & HABITAT VIOLIN PLOTS
# EL NINO
CTI_Habitat2 <- ggplot(data=subset(KFM_Fish_Diversity_NoAge,SurveyYear>1993 & SurveyYear<2002 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, colour=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='A')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
CTI_Habitat_RD2 <- ggplot(data=subset(KFM_RovingFish_Diversity,SurveyYear>1993 & SurveyYear<2002 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, color=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='B')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))+ scale_x_discrete(limits=c("1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001"),labels=c("1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001"))
# Heat Blob
CTI_Habitatblob2 <- ggplot(data=subset(blobCommunity_VT,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, colour=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='C')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
CTI_Habitat_RDblob2 <- ggplot(data=subset(blobCommunity_RD,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, color=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='D')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
HabitatCTI2<- ggpubr::ggarrange(CTI_Habitat2+ rremove("xlab"), CTI_Habitatblob2+ rremove("xlab")+ rremove("ylab"), CTI_Habitat_RD2,CTI_Habitat_RDblob2+ rremove("ylab"),
widths=c(0.52,0.5),
nrow = 2,ncol=2,
labels = NULL,align="h",common.legend = TRUE,legend='bottom')
HabitatCTI2
ggplot(data=subset(blobCommunity_RD,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, color=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='D')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
ggplot(data=subset(blobCommunity_RD,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, color=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='D')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))
ggplot(data=subset(blobCommunity_RD,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & Habitat !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=Habitat, color=Habitat))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='D')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))
View(blobCommunity_VT)
View(blobCommunity_RD)
# Which sites have urchin densities >4 per m^2 on average in 3 yrs prior to event?
BarrenSites<-blobURCHINS %>% filter(SurveyYear <2014 & SurveyYear>2010 & YearEstablished<2001) %>% group_by(SiteName) %>% dplyr::summarize(mean=mean(MeanDensity_sqm))
# Which sites have >80 stipes of adult macrocystis?
KelpSites<-KELP %>% filter(SurveyYear <2014 & SurveyYear>2010 & YearEstablished<2001) %>% filter(DimensionsMeasured=='Stipe_Count') %>% group_by(SiteName,SurveyYear) %>% dplyr::summarize(mean=mean(TotalCount))
###################### ROVING DIVER DATA #######################
blobCommunity_RD <- blobCommunity_RD %>%
mutate(Habitat = case_when(
SiteName=="Johnson's Lee North" ~ "Kelp",
SiteName=="Johnson's Lee South" ~ "Kelp",
SiteName=="Landing Cove" ~ "Kelp",
SiteName=="Wyckoff Ledge" ~ "Kelp",
SiteName=='Cathedral Cove' ~ "Kelp",
SiteName=="Fry's Harbor" ~ "Kelp",
SiteName=="Arch Point" ~ "Barren",
SiteName=="Pelican Bay" ~ "Barren",
SiteName=="Scorpion Anchorage" ~ "Barren",
SiteName=='Hare Rock' ~ "Barren",
SiteName=="SE Sea Lion Rookery" ~ "Barren",
SiteName=="Cat Canyon" ~ "Barren",
SiteName=="Yellow Banks" ~ "Mixed",
SiteName=="Gull Island South" ~ "Mixed",
SiteName=="Admiral's Reef" ~ "Mixed",
SiteName=="Rodes Reef" ~ "Mixed"))
blobCommunity_RD$Habitat <- factor(blobCommunity_RD$Habitat,
levels = c("Kelp","Barren", "Mixed"))
### CTI
# CTI model; barrens only
mBarren5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixed5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5Blob)
### CTI
# CTI model; barrens only
mBarren5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & Habitat=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5Blob)
summary(mKelp5Blob)
# CTI model; kelp only
mKelp5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & Habitat=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mKelp5Blob)
# CTI model; mixed habitat only
mMixed5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mMixed5Blob)
# CTI model; mixed habitat only
mMixed5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & Habitat=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mMixed5Blob)
ggplot(data=subset(blobCommunity_VT,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & Habitat !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=Habitat, colour=Habitat))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='C')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
ggplot(data=subset(blobCommunity_RD,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & Habitat !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=Habitat,color=Habitat))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='D')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
##### COMMUNITY THERMAL INDEX & HABITAT VIOLIN PLOTS
# EL NINO
CTI_Habitat2 <- ggplot(data=subset(KFM_Fish_Diversity_NoAge,SurveyYear>1993 & SurveyYear<2002 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, colour=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='A')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
CTI_Habitat_RD2 <- ggplot(data=subset(KFM_RovingFish_Diversity,SurveyYear>1993 & SurveyYear<2002 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, color=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='B')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))+ scale_x_discrete(limits=c("1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001"),labels=c("1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001"))
# Heat Blob
CTI_Habitatblob2 <- ggplot(data=subset(blobCommunity_VT,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, colour=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='C')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
CTI_Habitat_RDblob2 <- ggplot(data=subset(blobCommunity_RD,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, color=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='D')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))+ylim(c(18,22))
HabitatCTI2<- ggpubr::ggarrange(CTI_Habitat2+ rremove("xlab"), CTI_Habitatblob2+ rremove("xlab")+ rremove("ylab"), CTI_Habitat_RD2,CTI_Habitat_RDblob2+ rremove("ylab"),
widths=c(0.52,0.5),
nrow = 2,ncol=2,
labels = NULL,align="h",common.legend = TRUE,legend='bottom')
HabitatCTI2
ggplot(data=subset(blobCommunity_RD,SurveyYear>2010 & SurveyYear<2020 & YearEstablished<2001 & HabitatSensitivity !='Mixed'))+
geom_violin(aes(x=as.factor(SurveyYear),y=CTI,fill=HabitatSensitivity, color=HabitatSensitivity))+
ylab('CTI')+ xlab("Year")+ theme_JMS()+
theme(axis.text.x=element_text(angle=45, hjust=1),legend.position='bottom')+
labs(tag='D')+scale_fill_manual(values=c("#368F8B",'#DDBEA8'))+
scale_color_manual(values=c("#368F8B",'#DDBEA8'))
ggsave(filename="HabitatCTI_Sensitivity",height=6, width=8, units="in", plot=HabitatCTI2, device="png")
### CTI
# CTI model; barrens only
mBarren5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixed5=lme(data=subset(KFM_RovingFish_Diversity,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5)
summary(mKelp5)
summary(mMixed5)
########## MODEL COMMUNITY CHANGE FOR EACH HABITAT TYPE SEPARATELY ##########
### CTI
# CTI model; barrens only
mBarrenBlob<-lme(data=subset(blobCommunity_VT,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelpBlob<-lme(data=subset(blobCommunity_VT,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixedBlob<-lme(data=subset(blobCommunity_VT,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
### CTI
# CTI model; barrens only
mBarren5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Barren'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; kelp only
mKelp5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Kelp'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
# CTI model; mixed habitat only
mMixed5Blob=lme(data=subset(blobCommunity_RD,YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020 & HabitatSensitivity=='Mixed'),scale(CTI)~Status, random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mBarren5Blob)
summary(mKelp5Blob)
summary(mMixed5Blob)
# Change in Richness of each trophic group
mInvertivore<-lme(data=subset(Trophic_Richness,YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002 & Trophic.group=='Benthic invertivore'),scale(Trophic_Rich)~Status+scale(MeanDepth_ft), random=~1|IslandName/SiteName,weights=varIdent(form=~1|IslandName),na.action=na.omit)
summary(mInvertivore)
View(KFM_RovingDiverFishCount_82_19)
View(FishAffinities)
View(FishAffinitiesDecile)
View(FishAffinitiesQuartile)
View(FishAffinityList)
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001) %>% group_by(ScientificName) %>% distinct()
SPP<-KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001) %>% group_by(ScientificName) %>% distinct()
View(SPP)
SPP<-KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001) %>% select(ScientificName, T_MidPoint,T_Range,T_Affinity,Trophic.group,Water.column) %>% group_by(ScientificName) %>% distinct()
View(SPP)
SPP<-KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% select(ScientificName, T_MidPoint,T_Range,T_Affinity,Trophic.group,Water.column) %>% group_by(ScientificName) %>% distinct()
ggplot(SPP, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point()+theme_JMS()
ggplot(SPP, aes(x=T_Range, y=T_MidPoint,colour=ScientificName,na.omit=TRUE))+geom_point()+theme_JMS()
SPP <- filter(SPP, !is.na(T_MidPoint))
ggplot(SPP, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point()+theme_JMS()
ggplot(SPP, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point()+theme_JMS()+
theme(legend.text=element_text(face=italic))
ggplot(SPP, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point()+theme_JMS()+
theme(legend.text=element_text(face=italics))
ggplot(SPP, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point()+theme_JMS()+
theme(legend.text=element_text(face="italics"))
ggplot(SPP, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point()+theme_JMS()+
theme(legend.text=element_text(face="italic"))
SPPblob<-KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020) %>% select(ScientificName, T_MidPoint,T_Range,T_Affinity,Trophic.group,Water.column) %>% group_by(ScientificName) %>% distinct()
View(SPPblob)
SPPblob <- filter(SPPblob, !is.na(T_MidPoint))
View(SPPblob)
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")
View(blobCommunity_VT)
SPPblob <- SPPblob %>%
mutate(Trend = case_when(
ScientificName == "Embiotoca lateralis" ~ "decline",
ScientificName == "Sebastes atrovirens" ~ "decline",
ScientificName == "Sebastes serranoides" ~ "decline",
ScientificName == "Sebastes mystinus" ~ "decline",
ScientificName == "Rhacochilus vacca" ~ "decline El Nino",
ScientificName == "Paralabrax clathratus" ~ "increase Blob",
ScientificName == "Halichoeres semicinctus" ~ "increase Blob",
ScientificName == "Oxyjulis californica" ~ "increase Blob",
ScientificName == "Chromis punctipinnis" ~ "increase Blob",
ScientificName == "Semicossyphus pulcher" ~ "increase Blob",
ScientificName == "Hypsypops rubicundus" ~ "increase Blob",
ScientificName == "Embiotoca jacksoni" ~ "increase Blob"))
SPPblob$Trend <- SPPblob$Trend %>% replace_na('unchanged_unassessed')
SPPblob <- SPPblob %>%
mutate(Trend = case_when(
ScientificName == "Embiotoca lateralis" ~ "decline",
ScientificName == "Sebastes atrovirens" ~ "decline",
ScientificName == "Sebastes serranoides" ~ "decline",
ScientificName == "Sebastes mystinus" ~ "decline",
ScientificName == "Rhacochilus vacca" ~ "decline El Nino",
ScientificName == "Paralabrax clathratus" ~ "increase Blob",
ScientificName == "Halichoeres semicinctus" ~ "increase Blob",
ScientificName == "Oxyjulis californica" ~ "increase Blob",
ScientificName == "Chromis punctipinnis" ~ "increase Blob",
ScientificName == "Semicossyphus pulcher" ~ "increase Blob",
ScientificName == "Hypsypops rubicundus" ~ "increase Blob",
ScientificName == "Embiotoca jacksoni" ~ "increase Blob",
ScientificName == "Girella nigricans" ~ "unchanged"))
SPPblob$Trend <- SPPblob$Trend %>% replace_na('unassessed')
SPPblob$Trend
unique(SPPblob$Trend)
SPPblob$Trend <- factor(SPPblob$Trend,
levels = c("decline","decline El Nino", "increase Blob",
"unchanged", "unassessed"))
SPPblob$Trend
class(SPPblob$Trend)
levels(SPPblob$Trend)
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=Trend))+geom_point()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+scale_color_manual(values=c("#FFA006","#FFE7C1",'darkslateblue','darkgrey',"black"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=Trend))+geom_point()+ geom_jitter()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+ scale_color_manual(values=c("#FFA006","#FFE7C1",'darkslateblue','darkgrey',"black"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=Trend))+geom_point(size=3,alpha=0.5)+ geom_jitter()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+ scale_color_manual(values=c("#FFA006","#FFE7C1",'darkslateblue','darkgrey',"black"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=Trend))+geom_point(size=3,alpha=0.5)+ geom_jitter()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+ scale_color_manual(values=c("#FFA006","#FFE7C1",'slateblue','darkgrey',"black"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=Trend,fill=Trend))+geom_point(size=3,alpha=0.5)+ geom_jitter()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+ scale_color_manual(values=c("#FFA006","#FFE7C1",'slateblue','darkgrey',"black"))+ scale_fill_manual(values=c("#FFA006","#FFE7C1",'slateblue','darkgrey',"black"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+ geom_jitter()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+ geom_jitter()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+ scale_color_manual(values=c("blue","darkred"))+ scale_fill_manual(values=c("blue","darkred"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+ geom_jitter()+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+ scale_color_manual(values=c("blue","red"))+ scale_fill_manual(values=c("blue","red"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ggtitle("Heat Blob")+ scale_color_manual(values=c("blue","red"))+ scale_fill_manual(values=c("blue","red"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ scale_color_manual(values=c("blue","red"))+ scale_fill_manual(values=c("blue","red"))+ ylab("STI (°C)")+xlab("STR (°C)")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ scale_color_manual(values=c("slateblue","red"))+ scale_fill_manual(values=c("slateblue","red"))+ ylab("STI (°C)")+xlab("STR (°C)")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+theme_JMS()+
theme(legend.text=element_text(face="italic"))+ scale_color_manual(values=c("slateblue","red"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","red"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+theme_JMS()+
scale_color_manual(values=c("slateblue","red"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","red"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+theme_JMS()+
scale_color_manual(values=c("slateblue","red"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","red"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.5)+theme_JMS()+
scale_color_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.7)+theme_JMS()+
scale_color_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.6)+theme_JMS()+
scale_color_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.6)+theme_JMS()+
scale_color_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")+xlim(c(3,30))+ylim(c(10,30))
SPPblob<-KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001) %>% select(ScientificName, T_MidPoint,T_Range,T_Affinity,Trophic.group,Water.column) %>% group_by(ScientificName) %>% distinct()
View(SPPblob)
SPPblob <- filter(SPPblob, !is.na(T_MidPoint))
View(SPPblob)
SPPblob <- SPPblob %>%
mutate(Trend = case_when(
ScientificName == "Embiotoca lateralis" ~ "decline",
ScientificName == "Sebastes atrovirens" ~ "decline",
ScientificName == "Sebastes serranoides" ~ "decline",
ScientificName == "Sebastes mystinus" ~ "decline",
ScientificName == "Rhacochilus vacca" ~ "decline El Nino",
ScientificName == "Paralabrax clathratus" ~ "increase Blob",
ScientificName == "Halichoeres semicinctus" ~ "increase Blob",
ScientificName == "Oxyjulis californica" ~ "increase Blob",
ScientificName == "Chromis punctipinnis" ~ "increase Blob",
ScientificName == "Semicossyphus pulcher" ~ "increase Blob",
ScientificName == "Hypsypops rubicundus" ~ "increase Blob",
ScientificName == "Embiotoca jacksoni" ~ "increase Blob",
ScientificName == "Girella nigricans" ~ "unchanged"))
SPPblob$Trend <- SPPblob$Trend %>% replace_na('unassessed')
SPPblob$Trend <- factor(SPPblob$Trend,
levels = c("decline","decline El Nino", "increase Blob",
"unchanged", "unassessed"))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.6)+theme_JMS()+
scale_color_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")+xlim(c(3,30))+ylim(c(10,30))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.6)+theme_JMS()+
scale_color_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")+xlim(c(3,30))+ylim(c(10,25))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=ScientificName))+geom_point(size=3,alpha=0.6)+theme_JMS()+ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="none")+xlim(c(3,30))+ylim(c(10,25))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint,colour=T_Affinity,fill=T_Affinity))+geom_point(size=3,alpha=0.6)+theme_JMS()+
scale_color_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+ scale_fill_manual(values=c("slateblue","#A4303F"),name="Thermal Affinity")+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")+xlim(c(3,30))+ylim(c(10,25))
ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint))+geom_point(size=3,alpha=0.6)+theme_JMS()+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")+xlim(c(3,30))+ylim(c(10,25))
Correlation<-ggplot(SPPblob, aes(x=T_Range, y=T_MidPoint))+geom_point(size=3,alpha=0.6)+theme_JMS()+
ylab("STI (°C)")+xlab("STR (°C)")+theme(legend.position="bottom")+xlim(c(3,30))+ylim(c(10,25))
Correlation
ggsave(filename="Correlation",height=5, width=5, units="in", plot=Correlation, device="png")
ggsave(filename="Correlation",height=3, width=4, units="in", plot=Correlation, device="png")
ggsave(filename="Correlation",height=3, width=3, units="in", plot=Correlation, device="png")
view(SPPblob)
View(KFM_RovingDiverFishCount_82_19)
View(FishAffinities)
View(FishAffinitiesDecile)
View(FishAffinitiesQuartile)
View(FishAffinityList)
View(KFM_RovingFish_Diversity)
View(KFM_SiteAB_NoAgeNew)
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020) %>% filter(ScientificName=='Sebastes caurinus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgCount))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020) %>% filter(ScientificName=='Sebastes caurinus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgCount),sd_AB=sd(AvgCount))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>2010 & SurveyYear<2020) %>% filter(ScientificName=='Ophiodon elongatus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgCount),sd_AB=sd(AvgCount))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% filter(ScientificName=='Sebastes caurinus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgCount),sd_AB=sd(AvgCount))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% filter(ScientificName=='Sebastes caurinus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgAbundance),sd_AB=sd(AvgAbundance))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% filter(ScientificName=='Ophiodon elongatus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgAbundance),sd_AB=sd(AvgAbundance))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% filter(ScientificName=='Sebastes paucispinis') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgAbundance),sd_AB=sd(AvgAbundance))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% filter(ScientificName=='Pleuronichthys coenosus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgAbundance),sd_AB=sd(AvgAbundance))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% filter(ScientificName=='Citharichthys stigmaeus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgAbundance),sd_AB=sd(AvgAbundance))
KFM_RovingDiverFishCount_82_19 %>% filter(YearEstablished<2001 & SurveyYear>1993 & SurveyYear<2002) %>% filter(ScientificName=='Scorpaenichthys marmoratus') %>% group_by(SurveyYear) %>% dplyr::summarize(freq=length(unique(SiteName)),avg_AB=mean(AvgAbundance),sd_AB=sd(AvgAbundance))
